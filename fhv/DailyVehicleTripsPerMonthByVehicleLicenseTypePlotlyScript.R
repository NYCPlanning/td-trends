library(tidyverse)
library(plotly)

Time <- c("2021-11", "2021-10", "2021-09", "2021-08", "2021-07", "2021-06", "2021-05", "2021-04", "2021-03", 
          "2021-02", "2021-01", "2021-12", "2020-11", "2020-10", "2020-09", "2020-08", "2020-07", "2020-06", 
          "2020-05", "2020-04", "2020-03", "2020-02", "2020-01", "2019-12", "2019-11", "2019-10", "2019-09", 
          "2019-08", "2019-07", "2019-06", "2019-05", "2019-04", "2019-03", "2019-02", "2019-01", "2018-12",
          "2018-11", "2018-10", "2018-09", "2018-08", "2018-07", "2018-06", "2018-05", "2018-04","2018-03", 
          "2018-02", "2018-01", "2017-12", "2017-11", "2017-10", "2017-09", "2017-08", "2017-07", "2017-06",
          "2017-05", "2017-04", "2017-03", "2017-02", "2017-01", "2016-12", "2016-11", "2016-10", "2016-09",
          "2016-08", "2016-07", "2016-06", "2016-05", "2016-04", "2016-03", "2016-02", "2016-01", "2015-12", 
          "2015-11", "2015-10", "2015-09", "2015-08", "2015-07", "2015-06", "2015-05", "2015-04", "2015-03",
          "2015-02", "2015-01")

FHV <- c("534718", "573086", "460810", "502520", "520632", "542985", "516255", "510423", "501060", "450371",
         "418736", "411143", "423078", "463495", "441095", "393289", "353237", "284057", "219860", "159732",
         "471948", "806835", "722743", "776951", "775688", "740840", "702944", "702662", "711728", "760483", 
         "783887", "787478", "812119", "780650", "743263", "769276", "759997", "747254", "718725", "705418",
         "691931", "702516", "696390", "693401", "702608", "683001", "635840", "636774", "595409", "570838",
         "547125", "505592", "496894", "502007", "496689", "492160", "506550", "474460", "440558", "447055",
         "414565", "408319", "391986", "362092", "354107", "358952", "346434", "337938", "310107", "325096",
         "274539", "286734", "277281", "276946", "219426", "169721", "141443", "141350", "136517", "129150",
         "104691","109041", "87766")

Green <- c("3607", "3574", "3190", "2693", "2698", "2891", "2843", "2896", "2703", "2305", "2467", "2681", 
           "2953", "3067", "2932", "2614", "2330", "2103", "1850", "1186", "7205", "13743", "13446", "11598",
           "12068", "12470", "12985", "12866", "13969", "15690", "16248", "17080", "19318", "20481", "20327", 
           "22083", "21858", "22889", "22193", "21468", "22048", "24610", "25693", "26642", "26967", "27461",
           "25564", "29223", "29136", "29858", "29409", "27976", "29503", "32544", "34174", "36024", "37341",
           "36509", "34497", "39488", "38272", "40405", "38741", "40241", "42979", "46817", "49573", "51458", 
           "50850", "52093", "46621", "51880", "50999", "52598", "49830", "49429", "49730", "54628", "57637",
           "55473", "55567", "56242", "48659")

Yellow <- c("115660", "111638", "98724", "89901", "91011", "94130", "80499", "71982", "61643", "48499", "44052",
            "47145", "50285", "54221", "44646", "32491", "25816", "18325", "11237", "7928", "96993", "217216",
            "206604", "220786", "227654", "231171", "217747", "194798", "202443", "231335", "244017", "247742",
            "252634", "250654", "247315", "263609", "271501", "284121", "267983", "253182", "253186", "290362",
            "297508", "310169", "304169", "303280", "282565", "306706", "309471", "315084", "298163", "271676",
            "277042", "321877", "325857", "334865", "332075", "327451", "313229", "337071", "336737", "350380",
            "337321", "320718", "332231", "371257", "381878", "397780", "393886", "392470", "351816", "369686",
            "377076", "397244", "374156", "359029", "372979", "410831", "424459", "435701", "430669", "444633",
            "411238")

df <- data.frame(Time, FHV, Green, Yellow)

fig <- plot_ly(df, x=~Time)
fig <- fig %>% add_lines(y=~FHV, name = "FHV", line = list(shape = "linear"))
fig <- fig %>% add_lines(y=~Green, name = "Green", line = list(shape ="linear"))
fig <- fig %>% add_lines(y=~Yellow, name = "Yellow", line = list(shape = "linear"))
fig <- fig %>% layout(title = "NYCTLC Daily Vehicle Trips Per Month, By Vehicle License Type, 2015-2021",
                      xaxis=list(title="Month/Year"), showgrid=F, yaxis=list(title="Number of Trips Per Day"), showgrid = FALSE)
fig <- fig %>% layout(margin = list(b=160), annotations=list(x=1, y=-0.2, text = "Data Source: NYCTLC", showarrow=F,
                                                             xref = "paper", yref = "paper", xanchor = "right", yanchor = "top", xshift = 0, yshift = 0, font = list(size=12, color = "grey")))
fig <- fig %>% config(displayModeBar = FALSE)


fig

path = "C:/Users/S_Sanich/Desktop/td-trends/fhv"

htmlwidgets::saveWidget(fig, paste0(path, "NYCTLCDailyTripsbyLicenseType.html"))
